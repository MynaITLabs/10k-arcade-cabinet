game.pong=function(){function e(e,t){if(a){var i=p.createBufferSource();i.buffer=e,i.playbackRate.value=t||1,i.connect(p.destination),i.start(0)}}function t(e,t){var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="arraybuffer",i.onload=function(){p.decodeAudioData(i.response,function(e){c[t]=e},function(e){console.error(e)})},i.send()}function i(){b=0,w=4,g=!0,v.reset(),r=s?80:50,y.height=r}document.querySelector("#at").innerHTML="Instructions: Press b to enter blind mode. Use the up and down arrow keys to move your paddle and bounce the ball to the computer paddle. As the ball moves back and forth across the screen, a sound will play to indicate how far away the ball is from your paddle. The more frequent the sound plays, the closer the ball is to your paddle. The less frequent the sound plays, the farther away it is. The sound also tells you if the ball is above or below your paddle. A higher pitch sound means the ball is above your paddle. A lower pitch sound means it's below your paddle. If the sound stops it means either you or the computer missed the ball. When this happens, press the enter or space key to restart the game. Finally, at the start of each game, the sound will play 4 times before launching the ball. The sound is at the exact pitch that indicates the ball is centered to your paddle, so use this to judge higher and lower pitches. To start, press space or enter. To return to the menu, press escape. To repeat these instructions, press r.";var s=!1,a=!0,h=kontra.canvas.width,o=kontra.canvas.height,n=5,r=s?80:50,d=o/2-r/2,l=kontra.sprite,u=kontra.context;try{var p=new(window.AudioContext||window.webkitAudioContext),c={};t("media/blip.mp3","blip"),t("media/bounce.mp3","bounce"),t("media/wallbounce.mp3","wallbounce")}catch(e){return void(a=!1)}var y=l({x:n,y:d,width:n,height:r,color:"#fff",score:0,dy:4,update:function(){game.upPressed?this.y-=this.dy:game.downPressed&&(this.y+=this.dy)}});y.position.clamp(0,0,h,o-r);var f=l({x:h-2*n,y:o/2-25,width:n,height:50,color:"#fff",score:0,dy:4,update:function(){var e=x.alive?x:v;e.alive&&(e.y<this.y?this.y-=this.dy:e.y>this.y&&(this.y+=this.dy))}});f.position.clamp(0,0,h,o-r);var m=0,v=l({width:10,height:10,color:"#fff",reset:function(){this.x=h/2-5,this.y=o/2-5,this.startMinSpeed=s?1:3,this.startMaxSpeed=s?3:6.25,this.minSpeed=this.startMinSpeed,this.maxSpeed=this.startMaxSpeed,this.dx=3,this.dy=s?0:Math.random()>.5?-3:3,this.alive=!0},update:function(t){if(this.advance(),s){m+=t;var i=.1+(v.x-y.x)/h,a=0;this.y+this.height<y.y?a=(y.y-(this.y+this.height))/o:this.y>y.y+y.height&&(a=(y.y+y.height-v.y)/o),m>i&&(e(c.blip,1+a),m=0)}this.y<0?(this.y=0,this.dy=-this.dy,e(c.wallbounce)):this.y>o-this.height&&(this.y=o-this.height,this.dy=-this.dy,e(c.wallbounce)),this.x<0?(f.score++,this.alive=!1):this.x>h&&(y.score++,this.alive=!1);var n=!1;if(this.x>y.x&&this.collidesWith(y)?(n=y,this.x=y.x+y.width):this.x<f.x+f.width&&this.collidesWith(f)&&(n=f,this.x=f.x-this.width),n){e(c.bounce),this.minSpeed+=.2,this.maxSpeed+=.2;var r=s?.5:.8,d=y.height/2,l=(this.y+this.height/2-(n.y+n.height/2))/d;l=Math.max(Math.min(l,r),-r);var u=Math.max(Math.min(Math.abs(l)*this.maxSpeed,this.maxSpeed),this.minSpeed);this.dx=Math.abs(u*Math.sin(90*(1-l)*Math.PI/180)),this.dy=u*Math.cos((90-90*l)*Math.PI/180),n===f?this.dx=-this.dx:(x.x=this.x,x.y=this.y,x.dy=1.5*this.dy,x.dx=1.5*this.dx,x.alive=!0)}}}),x=l({width:v.width,height:v.height,dx:4,alive:!1,update:function(){this.advance(),(this.y<0||this.y>o)&&(this.dy=-this.dy)}}),b=0,w=0,g=!1,k=kontra.gameLoop({update:function(t){return b+=t,kontra.keys.pressed("b")&&!v.alive?(s=!0,i(),v.alive=!1,g=!1,void(a||alert("Your browser does not support the Web Audio API and thus cannot play the sounds needed to support blind play. Please use a different browser to play this game."))):(game.escPressed&&(b=0,g=!1,v.alive=!1,x.alive=!1,k.stop(),setTimeout(function(){y.x=n,y.y=d,f.x=h-2*n,f.y=o/2-25},100),game.goBack()),kontra.keys.pressed("r")&&(kontra.canvas.blur(),window.setTimeout(function(){kontra.canvas.focus()},100)),void(s&&g?(b>1&&(e(c.blip),w--,b=0),0===w&&(g=!1)):(game.updateKeys(),game.enterPressed&&!v.alive&&b>.16&&i(),y.update(),f.update(),v.alive&&v.update(t),x.alive&&(x.update(),x.x>f.x&&(x.alive=!1)))))},render:function(){u.fillStyle="#fff",u.font="60px monospace";for(var e=5;e<o;e+=20)u.fillRect(h/2-2,e,4,10);u.fillText(y.score+" "+f.score,156,60),y.render(),f.render(),v.alive&&v.render()}});return k}();